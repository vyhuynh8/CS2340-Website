<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="stylesheet.css">
</head>
<body cz-shortcut-listen="true">
<form action="/landing.html">

    <div class="fixed-center blocked container">
        <label><b>Email:</b></label>
        <input type="text" placeholder="Enter Username" name="email" required>

        <label><b>Password:</b></label>
        <input type="password" placeholder="Enter Password" name="password" required>

    </div>

</form>

<button class="button" onclick="return sendloginReq();" style="width:130px" type="submit">Login</button>

<script>
    function sendHTTP() {

        var data = JSON.stringify(false);

        var xhr = new XMLHttpRequest();
        xhr.withCredentials = true;

        xhr.addEventListener("readystatechange", function () {
            if (this.readyState === 4) {
                console.log(this.responseText);
            }
        });

        xhr.open("POST", "http://umb.kaangoksal.com:5235/login");
        xhr.setRequestHeader("authorization", "Basic a2Fhbmdva3NhbEBnbWFpbC5jb206Y3VrdWJpaw==");
        xhr.setRequestHeader("content-type", "application/json");
        xhr.setRequestHeader("cache-control", "no-cache");
        xhr.setRequestHeader("postman-token", "2fd56f43-8af6-87f9-443d-691f40567566");

        xhr.send(data);
    }

    function sendloginReq() {
        var base64encoded = "Basic" + " " + btoa(document.getElementsByName('email')[0].value + ":" + document.getElementsByName('password')[0].value);


        var data = JSON.stringify(false);
        var xhttp = new XMLHttpRequest();

        xhttp.onreadystatechange = function() {
            if (xhttp.readyState == 4 && xhttp.status == 200) {
                console.log(" Response : " + xhttp.responseText);
                if (xhttp.responseText == "<html><body><h1>Login Failed, Wrong Password</h1></body></html>") {
                    alert("LOGIN FAILED.");
                }
                else {
                    window.location.replace("landing.html");
                    localStorage.setItem("email", document.getElementsByName('email')[0].value);
                    localStorage.setItem("password", document.getElementsByName('password')[0].value);
                }
            }
        };
        xhttp.open("POST", "http://umb.kaangoksal.com:5235/login", true);
        xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhttp.setRequestHeader("authorization", base64encoded);
        xhttp.send(data);
        console.log("Sent Request");
    }

</script>
</body>
</html>